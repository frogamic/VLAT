language: node_js
node_js: '8.10'
before_install: 'cd ./api'
install: 'npm install'
script: 'npm run coverage'
after_success: 'cat ./coverage/lcov.info | ./node_modules/.bin/coveralls && rm -rf ./coverage'
before_deploy: npm install -g serverless
deploy:
  - provider: script
    skip_cleanup: true
    script: sls deploy
    on:
      branch: master
  - provider: script
    skip_cleanup: true
    script: sls deploy --stage prod
    on:
      branch: deploy
